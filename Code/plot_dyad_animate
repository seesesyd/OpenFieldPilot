plot_dyad_animate <- function(xy.df, ID1, ID2, FRAME_MIN, FRAME_MAX){
  library(gganimate)
  library(gifski)
  library(transformr)
  library(tidyverse)
  library(ggplot2)
  
  points <- NULL
  for (i in FRAME_MIN:FRAME_MAX) {
    xy.dfrandtime <- xy.df[xy.df$Frame == i,]
    xy.dfsim <- subset(xy.dfrandtime[,2:3])
    
    crk <- xy.dfsim
    
    pts <- as.data.frame(xy.dfsim)
    
    crk <- as.data.frame(crk)
    
    crk$id <- xy.dfrandtime$id
    
    crk$Frame <- i
    
    points[[i]] <- crk
  }
  
  points <- data.table::rbindlist(points)
  
  dists2 <- NULL
  for (i in FRAME_MIN:FRAME_MAX) {
    pointsprogtime <- points[points$Frame == i,]
    
    pointsprogtime$Ax <- pointsprogtime$x[ pointsprogtime$id == ID1 ]
    pointsprogtime$Bx <- pointsprogtime$x[ pointsprogtime$id == ID2 ]
    pointsprogtime$Ay <- pointsprogtime$y[ pointsprogtime$id == ID1 ]
    pointsprogtime$By <- pointsprogtime$y[ pointsprogtime$id == ID2 ]
    
    pointsprogtime$distance = sqrt( abs (pointsprogtime$Ax - pointsprogtime$Bx )^2 + abs( pointsprogtime$Ay - pointsprogtime$By )^2 )
    
    cri <- pointsprogtime
    
    cri <- as.data.frame(cri)
    
    cri$Frame <- i
    
    dists2[[i]] <- cri
  }
  
  dists2 <- data.table::rbindlist(dists2)
  
  ggplot()+
    geom_point(data = points, aes(x,y, color = factor(id)))+ geom_text(data = points, aes(x, y, label=id),hjust=1, vjust=1) +
    geom_segment(data = dists2, aes(
      x = Ax,
      y = Ay, 
      xend = Bx, 
      yend = By, 
      color = "black"
    )
    ) +
    scale_color_manual(values = c("#FFD833", "#FFBA33", "#FF5733", "#C70039", "#900C3F", "#581845", "black")) +
    transition_time(Frame)+
    theme_classic()
  
}
